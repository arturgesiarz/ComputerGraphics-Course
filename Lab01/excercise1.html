<!DOCTYPE html>

<html>
  <head>
    <title>Excercise 01</title>
    <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1" />

    <meta
      name="viewport"
      content="width=device-width, height=device-height, initial-scale=1"
    />
    <style type="text/css">
      body {
        background-color: #000000;
        overflow: hidden;
      }
    </style>
    <script src="three.js"></script>
    <script src="Detector.js"></script>
  </head>
  <body>
    <div id="WebGLCanvas"></div>
    <script>
      var scene;
      var camera;
      var christmassTree;
      var gregoryHouse;
      var car;

      initializeScene();
      animateScene();

      function buildChristmassTree() {
        var tree = new THREE.Group();

        // Trunk
        var trunkGeometry = new THREE.CylinderGeometry(0.5, 0.5, 1.5, 20);
        var trunkMaterial = new THREE.MeshBasicMaterial({
          color: 0x5e3d04,
          side: THREE.DoubleSide,
        });
        var trunkMesh = new THREE.Mesh(trunkGeometry, trunkMaterial);

        // Leafs - Geometry
        var leafs = new THREE.Group();

        var leafs1Geometry = new THREE.ConeGeometry(2, 5, 8);
        var leafs2Geometry = new THREE.ConeGeometry(2, 5, 8);
        var leafs3Geometry = new THREE.ConeGeometry(2, 5, 8);

        // Leafs - Edges
        var leafs1Edges = new THREE.EdgesGeometry(leafs1Geometry);
        var leafs2Edges = new THREE.EdgesGeometry(leafs2Geometry);
        var leafs3Edges = new THREE.EdgesGeometry(leafs3Geometry);

        var leafsLineMaterial = new THREE.LineBasicMaterial({
          color: 0x000000,
        });

        var leafs1Wireframe = new THREE.LineSegments(
          leafs1Edges,
          leafsLineMaterial
        );
        var leafs2Wireframe = new THREE.LineSegments(
          leafs2Edges,
          leafsLineMaterial
        );
        var leafs3Wireframe = new THREE.LineSegments(
          leafs3Edges,
          leafsLineMaterial
        );

        // Leafs - Material
        var leafsMaterial = new THREE.MeshBasicMaterial({
          color: 0x3c5700,
          side: THREE.DoubleSide,
        });

        // Leafs - Mesh
        var leafs1Mesh = new THREE.Mesh(leafs1Geometry, leafsMaterial);
        leafs1Mesh.add(leafs1Wireframe);
        leafs1Mesh.position.set(0, 2, 0);

        var leafs2Mesh = new THREE.Mesh(leafs2Geometry, leafsMaterial);
        leafs2Mesh.add(leafs2Wireframe);
        leafs2Mesh.position.set(0, 4, 0);

        var leafs3Mesh = new THREE.Mesh(leafs3Geometry, leafsMaterial);
        leafs3Mesh.add(leafs3Wireframe);
        leafs3Mesh.position.set(0, 6, 0);

        leafs.add(leafs1Mesh);
        leafs.add(leafs2Mesh);
        leafs.add(leafs3Mesh);

        leafs.position.set(-4, -3, 0);
        trunkMesh.position.set(-4, -4, 0);

        tree.add(leafs);
        tree.add(trunkMesh);

        tree.position.set(-2, 1, -4);

        christmassTree = leafs;

        scene.add(tree);
      }

      function buildGregoryHouse() {
        var house = new THREE.Group();

        // Block
        var blockGeometry = new THREE.CubeGeometry(3, 3, 3);
        var blockMaterials = [
          new THREE.MeshBasicMaterial({ color: 0x808380 }),
          new THREE.MeshBasicMaterial({ color: 0x808080 }),
          new THREE.MeshBasicMaterial({ color: 0x808380 }),
          new THREE.MeshBasicMaterial({ color: 0x808080 }),
          new THREE.MeshBasicMaterial({ color: 0x8ab080 }),
          new THREE.MeshBasicMaterial({ color: 0x808080 }),
        ];
        var blockMaterial = new THREE.MeshFaceMaterial(blockMaterials);
        var blockLineMaterial = new THREE.LineBasicMaterial({
          color: 0x000000,
        });
        var blockEdges = new THREE.EdgesGeometry(blockGeometry);
        var blockWireframe = new THREE.LineSegments(
          blockEdges,
          blockLineMaterial
        );
        var blockMesh = new THREE.Mesh(blockGeometry, blockMaterial);
        blockMesh.add(blockWireframe);
        blockMesh.position.set(4, -0.5, 4.0);

        // Roof
        // todo

        scene.add(blockMesh);
      }

      function buildCar() {
        // todo
      }

      function initializeScene() {
        if (Detector.webgl) {
          renderer = new THREE.WebGLRenderer({ antialias: true });
        } else {
          renderer = new THREE.CanvasRenderer();
        }
        renderer.setClearColor(0x34b7eb, 1);

        canvasWidth = window.innerWidth;
        canvasHeight = window.innerHeight;

        renderer.setSize(canvasWidth, canvasHeight);
        document.getElementById("WebGLCanvas").appendChild(renderer.domElement);

        scene = new THREE.Scene();
        camera = new THREE.PerspectiveCamera(
          45,
          canvasWidth / canvasHeight,
          1,
          100
        );
        camera.position.set(0, 0, 15);
        camera.lookAt(scene.position);
        scene.add(camera);

        buildChristmassTree();
        buildGregoryHouse();
        buildCar();
      }

      function animateScene() {
        christmassTree.rotation.y += 0.01;
        // cat.rotation.y += 0.01; // todo

        requestAnimationFrame(animateScene);
        renderScene();
      }

      function renderScene() {
        renderer.render(scene, camera);
      }
    </script>
  </body>
</html>
